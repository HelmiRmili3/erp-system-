# Use full SDK in dev mode
FROM mcr.microsoft.com/dotnet/sdk:9.0 AS dev
WORKDIR /app

# Copy only solution + props first (for restore caching)
COPY *.sln ./
COPY Directory.Packages.props ./
COPY Directory.Build.props ./

COPY src/Domain/*.csproj ./src/Domain/
COPY src/Application/*.csproj ./src/Application/
COPY src/Infrastructure/*.csproj ./src/Infrastructure/
COPY src/Web/*.csproj ./src/Web/

RUN dotnet restore src/Web/Web.csproj

# Copy everything
COPY . .

# Run the app in watch (hot reload) mode
ENTRYPOINT ["dotnet", "watch", "run", "--project", "src/Web/Web.csproj", "--urls", "http://+:5000"]
